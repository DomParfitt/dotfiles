- defaults:
    link:
      create: true
      relink: true
      force: true
    shell:
      stderr: true
      quiet: true

- clean:
    ~/:

- shell:
    - description: Installing git submodules
      command: git submodule update --init --recursive
    - description: Adding user to sudoers
      command: echo "${USER} ALL=(ALL) NOPASSWD:ALL" | sudo tee "/etc/sudoers.d/${USER}"
      stdin: true
      stdout: true
    - description: Installing Antigen
      command: |
        if ! command -v curl > /dev/null 2>&1; then
          exit 1
        fi

        if ! [[ -r "$HOME/antigen.zsh" ]]; then
          curl -L git.io/antigen > "$HOME/antigen.zsh"
        fi
    - description: Installing Oh My ZSH!
      command: |
        if ! command -v zsh > /dev/null 2>&1; then
          exit 1
        fi

        if ! [[ -d "$HOME/.oh-my-zsh" ]]; then
          sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
        fi

- link:
    ~/.aliases: aliases
    ~/.config/alacritty: alacritty
    ~/.config/bspwm: bspwm
    ~/.config/Code/User/keybindings.json: vscode/keybindings.json
    ~/.config/Code/User/settings.json: vscode/settings.json
    ~/.config/git: git
    ~/.config/i3: i3
    ~/.config/i3status: i3status
    ~/.config/nvim: nvim
    ~/.config/polybar: polybar
    ~/.config/sxhkd: sxhkd
    ~/.config/tealdeer: tealdeer
    ~/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-appfinder.xml: xfce/xfce4-appfinder.xml
    ~/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-panel.xml: xfce/xfce4-panel.xml
    ~/.fonts: fonts
    ~/.p10k.zsh: p10k.zsh
    ~/.profile: profile
    ~/.ssh/config: ssh/config
    ~/.tmux.conf: tmux.conf
    ~/.vim/autoload/plug.vim: plug.vim
    ~/.vimrc: vimrc
    ~/.Xresources: Xresources
    ~/.zprofile: profile
    ~/.zshrc: zshrc
    ~/bin: bin

- create:
    - ~/projects
    - ~/.zfunc

- shell:
    - description: Installing Node via NVM
      command: zsh -ic 'nvm install --lts && exit'
    - description: Installing VSCode Extensions
      command: |
        if command -v code > /dev/null 2>&1; then
          xargs -L 1 code --install-extension < vscode/extensions.txt
        fi
      stdout: true
    - description: Installing/Updating Rust
      command: |
        if ! [[ -d "$HOME/.rustup" ]]; then
          curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
        else
          rustup update
        fi
    - description: Setting default shell to zsh
      command: chsh -s $(which zsh)
      stdin: true
      stdout: true
