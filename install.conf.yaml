- defaults:
    link:
      create: true
      relink: true
      force: true
    shell:
      stderr: true
      quiet: true

- clean:
    ~/:
    ~/.config:
      recursive: true

- create:
    - ~/projects
    - ~/.zfunc

- shell:
    - description: Installing git submodules
      command: git submodule update --init --recursive
    - description: Adding user to sudoers
      command: echo "${USER} ALL=(ALL) NOPASSWD:ALL" | sudo tee "/etc/sudoers.d/${USER}" > /dev/null
      stdin: true
      stdout: true
    - description: Installing Antigen
      command: command -v curl && [[ -r "$HOME/antigen.zsh" ]] || curl -L git.io/antigen > "$HOME/antigen.zsh"
    - description: Installing Oh My ZSH!
      command: command -v zsh && [[ -d "$HOME/.oh-my-zsh" ]] || sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"

- link:
    ~/.aliases: aliases
    ~/.config/alacritty: alacritty
    ~/.config/bspwm: bspwm
    ~/.config/Code/User/keybindings.json: vscode/keybindings.json
    ~/.config/Code/User/settings.json: vscode/settings.json
    ~/.config/git: git
    ~/.config/i3: i3
    ~/.config/i3status: i3status
    ~/.config/kitty: kitty
    ~/.config/nvim: nvim
    ~/.config/polybar: polybar
    ~/.config/sxhkd: sxhkd
    ~/.config/tealdeer: tealdeer
    ~/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-appfinder.xml: xfce/xfce4-appfinder.xml
    ~/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-panel.xml: xfce/xfce4-panel.xml
    ~/.fonts: fonts
    ~/.functions: functions
    ~/.p10k.zsh: p10k.zsh
    ~/.ssh/config: ssh/config
    ~/.tmux.conf: tmux.conf
    ~/.vim/autoload/plug.vim: plug.vim
    ~/.vimrc: vimrc
    ~/.Xresources: Xresources
    ~/.zshrc: zshrc
    ~/bin: bin

- shell:
    - description: Installing Node via NVM
      command: zsh -ic 'nvm install --lts'
    - description: Installing npm packages
      command: zsh -ic 'nvm_load && xargs npm install -g < packages/npm'
    - description: Installing VSCode Extensions
      command: comm -13 <(code --list-extensions) <(cat vscode/extensions.txt) | xargs -L 1 code --install-extension
    - description: Installing/Updating Rust
      command: |
        if ! [[ -d "$HOME/.rustup" ]]; then
          curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
        else
          rustup update
        fi
    - description: Installing cargo packages
      command: zsh -ic 'xargs cargo install < packages/cargo'
    - description: Installing pip packages
      command: xargs pip install --user --upgrade < packages/pip
    - description: Setting default shell to zsh
      command: '[[ $(getent passwd $USER | cut -d: -f7) =~ zsh$ ]] || chsh -s $(which zsh)'
      stdin: true
      stdout: true
